FROM nodesource/trusty:6.3.0

RUN apt-get update
RUN apt-get install -qqy software-properties-common
RUN add-apt-repository -y ppa:openjdk-r/ppa
RUN apt-get update
RUN sudo apt-get install --no-install-recommends -y openjdk-8-jre

# install Firefox
RUN apt-get install -qqy firefox

# install xvfb
RUN apt-get install -y xvfb;

# install java; needed by selenium
#RUN apt-get install -y --no-install-recommends default-jre

# Gulp, bower
RUN npm install -g gulp bower web-component-tester

ADD . /code/
WORKDIR /code
RUN npm install && bower install --allow-root --config.interactive=false -s
RUN gulp build

# Run test
CMD test.sh
